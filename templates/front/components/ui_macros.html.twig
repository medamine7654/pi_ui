{# UI Component Macros for Reusable Elements #}

{# Button Macro #}
{% macro button(text, variant = 'default', size = 'default', icon = null, href = null, type = 'button') %}
    {% set baseClasses = 'inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50' %}
    
    {% set variantClasses = {
        'default': 'bg-blue-600 text-white hover:bg-blue-700 focus-visible:ring-blue-600',
        'outline': 'border border-gray-300 bg-transparent hover:bg-gray-100 text-gray-700',
        'ghost': 'hover:bg-gray-100 text-gray-700',
        'destructive': 'bg-red-600 text-white hover:bg-red-700 focus-visible:ring-red-600'
    } %}
    
    {% set sizeClasses = {
        'default': 'h-10 px-4 py-2',
        'sm': 'h-9 px-3 text-sm',
        'lg': 'h-11 px-8',
        'icon': 'h-10 w-10'
    } %}
    
    {% set classes = baseClasses ~ ' ' ~ variantClasses[variant] ~ ' ' ~ sizeClasses[size] %}
    
    {% if href %}
        <a href="{{ href }}" class="{{ classes }}">
            {% if icon %}<span class="mr-2">{{ icon|raw }}</span>{% endif %}
            {{ text }}
        </a>
    {% else %}
        <button type="{{ type }}" class="{{ classes }}">
            {% if icon %}<span class="mr-2">{{ icon|raw }}</span>{% endif %}
            {{ text }}
        </button>
    {% endif %}
{% endmacro %}

{# Card Macro #}
{% macro card(content, header = null, footer = null, class = '') %}
    <div class="rounded-lg border border-gray-200 bg-white shadow-sm {{ class }}">
        {% if header %}
            <div class="border-b border-gray-200 px-6 py-4">
                {{ header|raw }}
            </div>
        {% endif %}
        <div class="px-6 py-4">
            {{ content|raw }}
        </div>
        {% if footer %}
            <div class="border-t border-gray-200 px-6 py-4">
                {{ footer|raw }}
            </div>
        {% endif %}
    </div>
{% endmacro %}

{# Badge Macro #}
{% macro badge(text, variant = 'default') %}
    {% set variantClasses = {
        'default': 'bg-gray-100 text-gray-800',
        'secondary': 'bg-gray-100 text-gray-800',
        'success': 'bg-green-100 text-green-800',
        'warning': 'bg-yellow-100 text-yellow-800',
        'danger': 'bg-red-100 text-red-800',
        'info': 'bg-blue-100 text-blue-800'
    } %}
    
    <span class="inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium {{ variantClasses[variant] }}">
        {{ text }}
    </span>
{% endmacro %}

{# Avatar Macro #}
{% macro avatar(user, size = 'default') %}
    {% set sizeClasses = {
        'sm': 'h-6 w-6 text-xs',
        'default': 'h-8 w-8 text-sm',
        'lg': 'h-10 w-10 text-base',
        'xl': 'h-12 w-12 text-lg'
    } %}
    
    <div class="relative inline-block">
        {% if user.avatar %}
            <img 
                src="{{ user.avatar }}" 
                alt="{{ user.name }}" 
                class="rounded-full object-cover {{ sizeClasses[size] }}"
            >
        {% else %}
            <div class="flex items-center justify-center rounded-full bg-gray-300 font-medium text-gray-700 {{ sizeClasses[size] }}">
                {{ user.name|first|upper }}
            </div>
        {% endif %}
    </div>
{% endmacro %}

{# Input Macro #}
{% macro input(name, type = 'text', placeholder = '', value = '', label = null, required = false, class = '') %}
    <div class="space-y-2 {{ class }}">
        {% if label %}
            <label for="{{ name }}" class="text-sm font-medium text-gray-700">
                {{ label }}
                {% if required %}<span class="text-red-500">*</span>{% endif %}
            </label>
        {% endif %}
        <input 
            type="{{ type }}" 
            id="{{ name }}" 
            name="{{ name }}" 
            placeholder="{{ placeholder }}"
            value="{{ value }}"
            {% if required %}required{% endif %}
            class="flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm placeholder:text-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent disabled:cursor-not-allowed disabled:opacity-50"
        >
    </div>
{% endmacro %}

{# Select Macro #}
{% macro select(name, options, selected = '', label = null, required = false, class = '') %}
    <div class="space-y-2 {{ class }}">
        {% if label %}
            <label for="{{ name }}" class="text-sm font-medium text-gray-700">
                {{ label }}
                {% if required %}<span class="text-red-500">*</span>{% endif %}
            </label>
        {% endif %}
        <select 
            id="{{ name }}" 
            name="{{ name }}"
            {% if required %}required{% endif %}
            class="flex h-10 w-full rounded-md border border-gray-300 bg-white px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-600 focus:border-transparent disabled:cursor-not-allowed disabled:opacity-50"
        >
            {% for value, text in options %}
                <option value="{{ value }}" {% if value == selected %}selected{% endif %}>{{ text }}</option>
            {% endfor %}
        </select>
    </div>
{% endmacro %}

{# Alert Macro #}
{% macro alert(message, type = 'info', dismissible = false) %}
    {% set typeClasses = {
        'info': 'bg-blue-50 border-blue-200 text-blue-800',
        'success': 'bg-green-50 border-green-200 text-green-800',
        'warning': 'bg-yellow-50 border-yellow-200 text-yellow-800',
        'error': 'bg-red-50 border-red-200 text-red-800'
    } %}
    
    <div class="rounded-lg border px-4 py-3 {{ typeClasses[type] }}" role="alert">
        <div class="flex items-start">
            <div class="flex-1">{{ message }}</div>
            {% if dismissible %}
                <button type="button" class="ml-3 inline-flex text-gray-400 hover:text-gray-500" data-action="click->alert#dismiss">
                    <svg class="h-5 w-5" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                    </svg>
                </button>
            {% endif %}
        </div>
    </div>
{% endmacro %}

{# Star Rating Display Macro #}
{% macro starRating(rating, showNumber = true) %}
    <div class="flex items-center gap-1">
        <svg class="h-4 w-4 fill-current text-yellow-400" viewBox="0 0 20 20">
            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
        </svg>
        {% if showNumber %}
            <span class="text-sm font-medium">{{ rating|number_format(1) }}</span>
        {% endif %}
    </div>
{% endmacro %}

{# Loading Skeleton Macro #}
{% macro skeleton(type = 'text', class = '') %}
    {% if type == 'text' %}
        <div class="h-4 bg-gray-200 rounded animate-pulse {{ class }}"></div>
    {% elseif type == 'avatar' %}
        <div class="h-10 w-10 bg-gray-200 rounded-full animate-pulse {{ class }}"></div>
    {% elseif type == 'card' %}
        <div class="rounded-lg border border-gray-200 p-4 {{ class }}">
            <div class="aspect-square bg-gray-200 rounded-lg animate-pulse mb-3"></div>
            <div class="space-y-2">
                <div class="h-4 bg-gray-200 rounded animate-pulse w-3/4"></div>
                <div class="h-3 bg-gray-200 rounded animate-pulse w-1/2"></div>
                <div class="h-3 bg-gray-200 rounded animate-pulse w-1/3"></div>
            </div>
        </div>
    {% endif %}
{% endmacro %}

