{% extends 'front/base.html.twig' %}

{% block title %}Services - RentAll{% endblock %}

{% block body %}
<div class="container mx-auto px-4 py-6">
    <section class="mb-6">
        <h1 class="text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl">Services</h1>
        <p class="mt-2 text-gray-600">Ajouter un service et rechercher rapidement.</p>
    </section>

    {% for message in app.flashes('success') %}
        <div class="mb-4 rounded-md border border-green-200 bg-green-50 px-4 py-3 text-sm text-green-700">{{ message }}</div>
    {% endfor %}
    {% for message in app.flashes('error') %}
        <div class="mb-4 rounded-md border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700">{{ message }}</div>
    {% endfor %}

    <section class="mb-8 rounded-lg border border-gray-200 bg-white p-6 shadow-sm">
        <h2 class="mb-4 text-lg font-semibold text-gray-900">Ajouter un service</h2>
        <form method="post" action="{{ path('app_service_create') }}" class="grid grid-cols-1 gap-4 md:grid-cols-2">
            <input type="hidden" name="_token" value="{{ csrf_token('create_service') }}">
            <div class="md:col-span-2">
                <label for="titre" class="mb-1 block text-sm font-medium text-gray-700">Titre</label>
                <input id="titre" name="titre" required class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm" />
            </div>
            <div>
                <label for="date_service" class="mb-1 block text-sm font-medium text-gray-700">Date</label>
                <input id="date_service" name="date_service" type="datetime-local" required class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm" />
            </div>
            <div class="md:col-span-2">
                <label for="description" class="mb-1 block text-sm font-medium text-gray-700">Description</label>
                <textarea id="description" name="description" rows="3" class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm"></textarea>
            </div>
            <div class="md:col-span-2">
                <button class="rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white hover:bg-blue-700">Ajouter</button>
            </div>
        </form>
    </section>

    <section class="mb-6">
        <form method="get" action="{{ path('app_services') }}" class="flex gap-3">
            <input
                type="text"
                name="q"
                value="{{ filters.q }}"
                placeholder="Rechercher par titre ou description..."
                class="w-full rounded-md border border-gray-300 px-3 py-2 text-sm"
            />
            <button class="rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium hover:bg-gray-50">Rechercher</button>
        </form>
    </section>

    <section>
        <div class="mb-4 text-sm text-gray-600">
            {{ services|length }} {{ services|length == 1 ? 'service' : 'services' }} trouve(s)
        </div>
        {% if services|length > 0 %}
            <div class="grid grid-cols-1 gap-4 md:grid-cols-2">
                {% for service in services %}
                    <div class="rounded-lg border border-gray-200 bg-white p-5 shadow-sm">
                        <h3 class="text-lg font-semibold text-gray-900">{{ service.titre }}</h3>
                        <p class="mt-1 text-sm text-gray-500">Le {{ service.dateService|date('d/m/Y H:i') }}</p>
                        <p class="mt-3 text-sm text-gray-700">{{ service.description ?: 'Aucune description.' }}</p>
                        <p class="mt-3 text-xs text-gray-500">Ajoute par {{ service.user.email }}</p>
                        <div class="mt-4">
                            <form method="post" action="{{ path('app_service_book', {id: service.id}) }}">
                                <input type="hidden" name="_token" value="{{ csrf_token('book_service_' ~ service.id) }}">
                                <button class="rounded-md bg-blue-600 px-3 py-2 text-sm font-medium text-white hover:bg-blue-700">Reserver</button>
                            </form>
                        </div>
                    </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="flex flex-col items-center justify-center py-12 text-center">
                <h3 class="mt-4 text-lg font-medium text-gray-900">Aucun service trouve</h3>
            </div>
        {% endif %}
    </section>
</div>
{% endblock %}
